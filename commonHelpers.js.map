{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\n\nexport async function fetchImages(searchQueryResult, currentPage) {\n  try {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const q = searchQueryResult;\n    const params = new URLSearchParams({\n      key: '42946583-b9bd64904b8b2d582b051d84e',\n      q: q,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 24,\n      page: currentPage,\n    });\n    const url = `${BASE_URL}?${params}`;\n    const res = await axios.get(url);\n    return res.data;\n  } catch (error) {\n    iziToast.error({\n      message: 'Server error!',\n      position: 'topRight',\n    });\n  }\n}","\nexport function renderGallery(data) {\n  return data.hits\n    .map(hit => {\n      const {\n        id,\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = hit;\n      return `\n    <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" id=${id} src=\"${webformatURL}\" alt=\"${tags}\"/>\n        </a>\n        <div class=\"gallery-item-info\">\n          <div class=\"item-info-atr\">\n          <h3>Likes</h3>\n          <p>${likes}</p>\n          </div>\n          <div class=\"item-info-atr\">\n          <h3>Views</h3>\n          <p>${views}</p>\n          </div>\n          <div class=\"item-info-atr\">\n          <h3>Comments</h3>\n          <p>${comments}</p>\n          </div>\n          <div class=\"item-info-atr\">\n          <h3>Downloads</h3>\n          <p>${downloads}</p>\n          </div>\n        </div>\n    </li>\n    `;\n    })\n    .join('');\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './js/pixabay-api';\nimport { renderGallery } from './js/render-function';\n\nexport const gallery = document.querySelector('.gallery');\nconst searchForm = document.querySelector('#search-form');\nconst loadMoreBtn = document.querySelector('#load-more-btn');\nconst elemLoader = document.querySelector('#loader');\nlet searchQueryResult;\nlet totalPage;\nlet currentPage;\nconst maxPage = 15;\nlet data;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n  gallery.innerHTML = '';\n  currentPage = 1;\n  searchQueryResult = event.target.elements.query.value;\n  if (searchQueryResult.trim() == '') {\n    iziToast.warning({\n      message: `The search field is empty. Please try again!`,\n      position: 'topRight',\n    });\n    searchForm.reset();\n    return;\n  } else {\n    try {\n      showElemLoader();\n      data = await fetchImages(searchQueryResult, currentPage);\n      totalPage = Math.ceil(data.totalHits / maxPage);\n      if (!data.hits.length) {\n        hideElemLoader();\n        iziToast.error({\n          message:\n            'Sorry, there are no images matching your search query. Please try again.',\n          position: 'topRight',\n        });\n        checkBtnStatus();\n      } else {\n        hideElemLoader();\n        const createMarkup = renderGallery(data);\n        gallery.insertAdjacentHTML('beforeend', createMarkup);\n        lightbox.refresh();\n        checkBtnStatus();\n      }\n    } catch (error) {\n      hideElemLoader();\n      iziToast.error({\n        message: `Error render gallery. Please try again!`,\n        position: 'topRight',\n      });\n    }\n    searchForm.reset();\n  }\n});\n\nloadMoreBtn.addEventListener('click', onLoadMoreBtn);\nasync function onLoadMoreBtn() {\n  currentPage += 1;\n  showElemLoader();\n  try {\n    data = await fetchImages(searchQueryResult, currentPage);\n    const createMarkup = renderGallery(data);\n    gallery.insertAdjacentHTML('beforeend', createMarkup);\n    lightbox.refresh();\n  } catch (error) {\n    iziToast.error({\n      position: 'topRight',\n      message: 'Error next render gallery',\n    });\n  }\n  hideElemLoader();\n  onScroll();\n  checkBtnStatus();\n}\n\nfunction onScroll() {\n  const galleryCard = document.querySelector('.gallery-image');\n  const cardHeight = galleryCard.getBoundingClientRect().height;\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction checkBtnStatus() {\n  if (currentPage >= totalPage) {\n    loadMoreBtn.classList.add('is-hidden');\n    iziToast.info({\n      message: \"We're sorry, there are no more images to load\",\n      position: 'topRight',\n    });\n  } else {\n    loadMoreBtn.classList.remove('is-hidden');\n  }\n}\n\nfunction hideElemLoader() {\n  elemLoader.classList.add('is-hidden');\n}\n\nfunction showElemLoader() {\n  elemLoader.classList.remove('is-hidden');\n}\n"],"names":["fetchImages","searchQueryResult","currentPage","BASE_URL","q","params","url","axios","iziToast","renderGallery","data","hit","id","webformatURL","largeImageURL","tags","likes","views","comments","downloads","gallery","searchForm","loadMoreBtn","elemLoader","totalPage","maxPage","lightbox","SimpleLightbox","event","showElemLoader","hideElemLoader","checkBtnStatus","createMarkup","onLoadMoreBtn","onScroll","cardHeight"],"mappings":"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"}